# Data Sharding

在分布式系统中，通过数据分片，能够支持系统水平拓展，负载均衡分配到多台机器中，突破单机性能限制。

## 分片方式

常见的分片方式有以下几种

- 哈希分片
  - 规则：对分片键（如用户 ID）计算哈希值，再按分片数取模。
  - 示例：用户 ID 哈希后分到 4 个库，每个库分 8 个表。
  - 优点：数据分布均匀，避免热点。
  - 缺点：扩容需重新哈希，迁移成本高。

- 范围分片
  - 规则：按分片键的范围划分数据（如用户 ID 或时间）。
  - 示例：用户 ID 1-1000 在库 1，1001-2000 在库 2。
  - 优点：范围查询高效。
  - 缺点：可能导致数据倾斜（如新数据集中到尾部）。

- 一致性哈希
  - 规则：使用哈希环分布数据，减少扩容时的数据迁移量。
  - 优点：动态扩容影响小。
  - 缺点：实现复杂，需维护虚拟节点。

- 业务分片
  - 规则：按业务属性（如租户 ID、地理位置）分片。
  - 示例：不同租户的数据存储在不同库。
  - 优点：业务隔离性好。
  - 缺点：需提前规划业务规模。

- 时间分片
  - 规则：按时间（年月）分库分表。
  - 示例：2023 年的数据在db_2023，按月分表为orders_202301、orders_202302。
  - 优点：便于冷热数据分离。
  - 缺点：历史数据查询需跨库。
